

<style type="text/css">
	
div#tabelData_paginate {
  margin-bottom: -30px;
  margin-top: -26px;
}

div#tabelData_filter {
  margin-bottom: -14px;
  margin-top: -3px;
}
.box-form {
  background-color: white;
  margin-bottom: -10px;
}

th { font-size: 12px; }
td { font-size: 12px; }

tr.trhide.odd {
    display: none;
}

div#divtahun {
    margin-left: 14px;
}

div#labelThn {
    /*margin-top: 16px;*/
}
</style>

<div class="row">
	<div id="breadcrumb" class="col-md-12">
		<ol class="breadcrumb">
			<li><a href="#"><label>Laporan</label></a></li>
			<li><a href="#"><label id="judul1"> </label></a></li> 
		</ol>
	</div>
</div>


<div class="row">
	<div  class="col-md-12">
		<div class="box">
		<div class="box-header">
	 		<div class="box-name">
				<i class="fa fa-user"></i>
				<span><label>LIST LAPORAN PAKET DATA MASUK DAN KELUAR</label></label></span>
			</div>
			<div class="box-icons">
				<a class="collapse-link">
					<i class="fa fa-chevron-up"></i>
				</a>
				<a class="expand-link">
					<i class="fa fa-expand"></i>
				</a>
				<!--<a class="close-link">
					<i class="fa fa-times"></i>
				</a>-->
			</div>
			<div class="no-move"></div>
		</div>
        <div class="box-content" style="padding-top: 0px;padding-bottom:0px;">
			<div class="row" id="filter" style="margin-left:5px;margin-right:5px;margin-top: 5px;">	
				<div  class="col-md-2">					
					<label>TANGGAL PERIODE</label>
				</div>	
				<div  class="col-md-2" style="padding-left:15px;padding-right:15px">					
					<input type="text" class="form-control" name="tgawal" id="tgawal" placeholder="Tanggal Awal" />
				</div>	
				<div  class="col-md-1" style="text-align: center;">					
					<label>S/D</label>
				</div>	
				<div  class="col-md-2" style="padding-left:15px;padding-right:15px">					
					<input type="text" class="form-control" name="tgahir" id="tgahir" placeholder="Tanggal Akhir" />
				</div>	

			</div>	

			<div class="row" id="filter" style="margin-left:5px;margin-right:5px;margin-top: 5px;">	
				<div  class="col-md-2">					
					<label>PAKET</label>
				</div>	
				<div  class="col-md-5">
                        <input type="hidden" class="populate placeholder" name="jenis" id="jenis" >
                        <input type="hidden" name="jenis_hidden" id="jenis_hidden" >
                    </div>

 			</div>	

			<div class="row">	

				<div  class="col-md-2" id="btload">
				&nbsp;
				</div>	
				<div  class="col-md-3" id="btload" style="padding-left:28px;padding-right:28px;padding-top:15px;">
		            <button type="button" class="btn btn-primary btn-app-sm" onclick="refreshlap()"><i class="fa fa-refresh" aria-hidden="true" style="font-size:30px"></i></button>
		            <button type="button" class="btn btn-primary btn-app-sm" onclick="tableToExcel('tabelData', 'laporan', 'laporan_paket.xls')"><i class="fa fa-print	" aria-hidden="true" style="font-size:30px"></i></button>
					<input type="hidden" name="linkpdf" id="linkpdf">
				</div>		        
	        </div>
	    </div>    
        </div>         
	</div>
</div>	

<div class="row">
	<div  class="col-md-12">
		<div class="box">
		<div class="box-header">
			<div class="box-name">
				<i class="fa fa-user"></i>
				<span><label>LIST LAPORAN KATEGORI PAKET MASUK</label></label></span>
			</div>
			<div class="box-icons">
				<a class="collapse-link">
					<i class="fa fa-chevron-up"></i>
				</a>
				<a class="expand-link">
					<i class="fa fa-expand"></i>
				</a>
				<!--<a class="close-link">
					<i class="fa fa-times"></i>
				</a>-->
			</div>
			<div class="no-move"></div>
		</div>
		<div class="box-content" style="padding-top: 5px;padding-bottom:3px;">

			<div class="row" id="filter2" style="margin-left:5px;margin-right:5px;margin-top: 5px;">	
				<div  class="col-md-2">					
					<label>TANGGAL PERIODE</label>
				</div>	
				<div  class="col-md-2" style="padding-left:15px;padding-right:15px">					
					<input type="text" class="form-control" name="tgawal2" id="tgawal2" placeholder="Tanggal Awal" />
				</div>	
				<div  class="col-md-1" style="text-align: center;">					
					<label>S/D</label>
				</div>	
				<div  class="col-md-2" style="padding-left:15px;padding-right:15px">					
					<input type="text" class="form-control" name="tgahir2" id="tgahir2" placeholder="Tanggal Akhir" />
				</div>	

			</div>	

			<div class="row" id="filter" style="margin-left:5px;margin-right:5px;margin-top: 5px;">	
				<div  class="col-md-2">					
					<label>KATEGORI</label>
				</div>	
				<div  class="col-md-5">
                        <input type="hidden" class="populate placeholder" name="kategori" id="kategori" >
                        <input type="hidden" name="kategori_hidden" id="kategori_hidden" >
                    </div>

 			</div>	

			<div class="row">	

				<div  class="col-md-2" id="btload2">
				&nbsp;
				</div>	
				<div  class="col-md-3" id="btload2" style="padding-left:28px;padding-right:28px;padding-top:15px;">
		            <button type="button" class="btn btn-primary btn-app-sm" onclick="refreshlappoli()"><i class="fa fa-refresh" aria-hidden="true" style="font-size:30px"></i></button>
		            <button type="button" class="btn btn-primary btn-app-sm" onclick="tableToExcel('tabelData', 'laporan', 'lapora_paket_kategori.xls')"><i class="fa fa-print	" aria-hidden="true" style="font-size:30px"></i></button>
					<input type="hidden" name="linkpdf" id="linkpdf">
				</div>		        
	        </div>
	    </div>    
        </div>         
	</div>
</div>	
<div class="row">
	<div  class="col-md-12">
		<div class="box">
		<div class="box-header">
	 		<div class="box-name">
				<i class="fa fa-user"></i>
				<span><label>LIST LAPORAN PAKET DISITA</label></label></span>
			</div>
			<div class="box-icons">
				<a class="collapse-link">
					<i class="fa fa-chevron-up"></i>
				</a>
				<a class="expand-link">
					<i class="fa fa-expand"></i>
				</a>
				<!--<a class="close-link">
					<i class="fa fa-times"></i>
				</a>-->
			</div>
			<div class="no-move"></div>
		</div>
        <div class="box-content" style="padding-top: 0px;padding-bottom:0px;">
			<div class="row" id="filter" style="margin-left:5px;margin-right:5px;margin-top: 5px;">	
				<div  class="col-md-2">					
					<label>TANGGAL PERIODE</label>
				</div>	
				<div  class="col-md-2" style="padding-left:15px;padding-right:15px">					
					<input type="text" class="form-control" name="tgawal" id="tgawal" placeholder="Tanggal Awal" />
				</div>	
				<div  class="col-md-1" style="text-align: center;">					
					<label>S/D</label>
				</div>	
				<div  class="col-md-2" style="padding-left:15px;padding-right:15px">					
					<input type="text" class="form-control" name="tgahir" id="tgahir" placeholder="Tanggal Akhir" />
				</div>	

			</div>	

			<div class="row" id="filter" style="margin-left:5px;margin-right:5px;margin-top: 5px;">	
				<div  class="col-md-2">					
					<label>UNIT</label>
				</div>	
				<div  class="col-md-5" id="divbarang">					
                        <input type="hidden" class="populate placeholder" name="filterbarang" id="filterbarang" >
                        <input type="hidden" name="filterbarang_hidden" id="filterbarang_hidden" >
				</div>	

 			</div>	

			<div class="row">	

				<div  class="col-md-2" id="btload">
				&nbsp;
				</div>	
				<div  class="col-md-3" id="btload" style="padding-left:28px;padding-right:28px;padding-top:15px;">
		            <button type="button" class="btn btn-primary btn-app-sm" onclick="refreshlap()"><i class="fa fa-refresh" aria-hidden="true" style="font-size:30px"></i></button>
		            <button type="button" class="btn btn-primary btn-app-sm" onclick="tableToExcel('tabelData', 'laporan', 'laporan.xls')"><i class="fa fa-print	" aria-hidden="true" style="font-size:30px"></i></button>
					<input type="hidden" name="linkpdf" id="linkpdf">
				</div>		        
	        </div>
	    </div>    
        </div>         
	</div>
</div>	

<div class="row" >
	<div  class="col-md-12">
		<div class="box">
	            <div  id="tData" name="tData" >
	            </div>
		</div>
	</div>
</div>

<div class="row" id="crekap" name="crekap" style="display: none">
	<div  class="col-md-4">
		<div class="box">
			<div class="box-header">
				<div class="box-name">
					<span>Rekap Progres Pekerjaan Pokja</span>
				</div>
			</div>
            <div  id="tDataRekap" name="tDataRekap" >
            </div>

		</div>
	</div>

	<div  class="col-md-4">
		<div class="box">
			<div class="box-header">
				<div class="box-name">
					<span>Progres Pokja ULP</span>
				</div>
			</div>
				<div id="progresStatus" style="min-height: 250px;"></div>
		</div>
	</div>

	<div  class="col-md-4">
		<div class="box">
			<div class="box-header">
				<div class="box-name">
					<span>Distribusi Pokja ULP</span>
				</div>
			</div>
				<div id="distribusiPokja" style="min-height: 250px;"></div>
		</div>
	</div>

</div>



<a id="dlink" style="display:none;"></a>


<script src="js/laporanperiode.js"></script>
<script src="plugins/select2/select2.min.js"></script>
<script src="plugins/jquery-ui-timepicker-addon/jquery-ui-timepicker-addon.min.js"></script>


<script type="text/javascript">

// Run Datables plugin and create 3 variants of settings
function AllTables(modul){
	$('#judul1').html(modul);
	$('#judul2').html(modul);
}


function refreshlap(){
    $("#tData").html('');
    loadLaporan();
}

function refreshlappoli(){
    $("#tData").html('');
    loadLaporan2();
}

function DrawAllMorrisCharts(){
	// rekapProgresPokja();
	// highchartPie();
	// MorrisChart1();
}

$(document).ready(function() {
    var modul=document.getElementById('modul').value;

    LoadDataTablesScripts(AllTables(modul));    
    // loadUnit();

    $('#tgawal').datepicker({
        format: 'mm/dd/yyyy',
        autoclose:true
    });    

    $('#tgahir').datepicker({
        format: 'mm/dd/yyyy',
        autoclose:true
    });    

    $('#tgawal2').datepicker({
        format: 'mm/dd/yyyy',
        autoclose:true
    });    

    $('#tgahir2').datepicker({
        format: 'mm/dd/yyyy',
        autoclose:true
    });    

   //var listItems ='';
    $('#jenis')
        .on("change", function(e) {
              var id=e.added.id;
              var txt=e.added.nama;  
              var nmhidden=this.id+'_hidden';
              //console.log(nmhidden);                              
              $('#'+nmhidden).attr('value',txt);
        })      
        .select2({
        placeholder: "Pilih Data", 
        ajax: {
                url: 'backend/public/api/admin/master/status',
                dataType: 'json',
                quietMillis: 100,
                data: function (term, page) {
                    return {
                        term: term, //search term
                        page_limit: 10 // page size
                    };
                     /*var listItems = '<option selected="selected" value="0">- Select -</option>';
 
                  for (var i = 0; i <=datacombo.length; i++) {
                         listItems += "<option value='" + datacombo[i].id + "'>" + datacombo[i].nama + "</option>";
                     }
             
                     $("#filterbarang").html(listItems);*/
                },
                results: function (data, page) {
                    return { results: data };
                },
            }
    });
    //var listItems ='';
    $('#kategori')
        .on("change", function(e) {
              var id=e.added.id;
              var txt=e.added.nama;  
              var nmhidden=this.id+'_hidden';
              //console.log(nmhidden);                              
              $('#'+nmhidden).attr('value',txt);
        })      
        .select2({
        placeholder: "Pilih Data", 
        ajax: {
                url: 'backend/public/api/admin/master/kategoriforcombo',
                dataType: 'json',
                quietMillis: 100,
                data: function (term, page) {
                    return {
                        term: term, //search term
                        page_limit: 10 // page size
                    };
                     /*var listItems = '<option selected="selected" value="0">- Select -</option>';
 
                  for (var i = 0; i <=datacombo.length; i++) {
                         listItems += "<option value='" + datacombo[i].id + "'>" + datacombo[i].nama + "</option>";
                     }
             
                     $("#filterbarang").html(listItems);*/
                },
                results: function (data, page) {
                    return { results: data };
                },
            }
});

    $('.form-control').tooltip();
    WinMove(); 

});




var tableToExcel = (function () {
        var uri = 'data:application/vnd.ms-excel;base64,'
        , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
        , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
        , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
        return function (table, name, filename) {
            if (!table.nodeType) table = document.getElementById(table)
            var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }

            document.getElementById("dlink").href = uri + base64(format(template, ctx));
            document.getElementById("dlink").download = filename;
            document.getElementById("dlink").click();

        }
    })();    

</script>


